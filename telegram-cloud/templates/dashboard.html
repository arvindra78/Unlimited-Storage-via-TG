<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Unlimited Storage Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <nav
        style="padding: 1rem 2rem; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center;">
        <div style="font-weight: 700; font-size: 1.25rem; color: white;">Unlimited <span
                style="color: var(--primary);">Storage</span></div>
        <div>
            <a href="{{ url_for('health') }}" style="margin-right: 1.5rem; color: #94a3b8;">System Health</a>
            <a href="{{ url_for('logout') }}" style="color: #ef4444;">Disconnect</a>
        </div>
    </nav>

    <div class="container">
        <!-- Upload Section -->
        <div class="glass-panel" style="margin-bottom: 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h2 style="margin:0; font-size: 1.5rem;">Secure Upload</h2>
                <span id="upload-status" style="color: #94a3b8; font-size: 0.9rem;">Ready</span>
            </div>

            <div style="display: flex; gap: 1rem;">
                <input type="file" id="file-input">
                <button onclick="uploadFile()" id="upload-btn">Post</button>
            </div>

            <div class="progress-container" id="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
        </div>

        <!-- File List -->
        <div class="glass-panel">
            <h2 style="margin-bottom: 1.5rem;">Storage</h2>
            <ul class="file-list">
                {% for file in files %}
                <li class="file-item" id="file-row-{{ file.id }}">
                    <div class="file-info">
                        <strong>{{ file.filename }}</strong>
                        <div class="file-meta">
                            {{ "%.2f"|format(file.size / 1024 / 1024) }} MB •
                            {{ file.chunks }} Segments •
                            {{ file.created_at }}
                        </div>
                    </div>

                    <div class="file-actions" style="align-items: center; gap: 1rem;">
                        <span class="status-badge status-{{ file.status }}" id="status-badge-{{ file.id }}">{{
                            file.status }}</span>

                        {% if file.status == 'completed' %}
                        <a href="{{ url_for('download_file', file_id=file.id) }}" class="btn"
                            style="padding: 0.5rem 1rem; font-size: 0.9rem;">Download</a>
                        {% endif %}

                        {% if file.status in ['completed', 'failed'] %}
                        <button onclick="deleteFile('{{ file.id }}')" class="btn btn-danger"
                            style="padding: 0.5rem 1rem; font-size: 0.9rem;">Delete</button>
                        {% endif %}
                    </div>
                </li>
                {% else %}
                <li style="text-align: center; color: #64748b; padding: 2rem;">
                    Storage is empty.
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>