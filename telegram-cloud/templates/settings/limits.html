{% extends "base.html" %}

{% block title %}Limits & Usage - TeleCloud{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-cyan-50 to-blue-50 py-8 px-4">
    <div class="max-w-2xl mx-auto">
        <!-- Header -->
        <div class="mb-6">
            <a href="{{ url_for('settings') }}"
                class="text-ag-cyan-600 hover:text-ag-cyan-700 font-semibold inline-flex items-center gap-2">
                ← Back to Settings
            </a>
            <h1 class="text-3xl font-bold text-slate-900 mt-4">Limits & Usage</h1>
            <p class="text-slate-600 mt-1">Your free plan limits</p>
        </div>

        <!-- Plan Card -->
        <div class="bg-white/70 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-slate-900">Current Plan</h2>
                <span class="px-3 py-1 bg-ag-cyan-100 text-ag-cyan-700 rounded-full text-sm font-semibold">Free</span>
            </div>
            <p class="text-slate-600 text-sm">You're on the free plan with generous limits for personal use.</p>
        </div>

        <!-- Daily Uploads -->
        <div class="bg-white/70 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl p-6 mb-6">
            <h2 class="text-lg font-semibold text-slate-900 mb-4">Daily Uploads</h2>

            <div class="mb-4">
                <div class="flex justify-between text-sm mb-2">
                    <span class="text-slate-600">{{ limits.daily_uploads.current }} / {{ limits.daily_uploads.max }}
                        uploads today</span>
                    <span
                        class="font-semibold {% if limits.daily_uploads.percentage >= 90 %}text-red-600{% elif limits.daily_uploads.percentage >= 70 %}text-amber-600{% else %}text-ag-cyan-600{% endif %}">
                        {{ limits.daily_uploads.percentage }}%
                    </span>
                </div>
                <div class="w-full h-3 bg-slate-200 rounded-full overflow-hidden">
                    <div class="h-full {% if limits.daily_uploads.percentage >= 90 %}bg-red-500{% elif limits.daily_uploads.percentage >= 70 %}bg-amber-500{% else %}bg-gradient-to-r from-ag-cyan-500 to-blue-500{% endif %} transition-all duration-300"
                        style="width: {{ limits.daily_uploads.percentage }}%"></div>
                </div>
                {% if limits.daily_uploads.current >= limits.daily_uploads.max %}
                <p class="text-sm text-red-600 mt-2">⚠ Daily limit reached. Resets in {{
                    limits.daily_uploads.resets_in_hours }} hours.</p>
                {% elif limits.daily_uploads.percentage >= 70 %}
                <p class="text-sm text-amber-600 mt-2">⚠ Approaching daily limit. {{ limits.daily_uploads.max -
                    limits.daily_uploads.current }} uploads remaining.</p>
                {% else %}
                <p class="text-sm text-slate-600 mt-2">Resets in {{ limits.daily_uploads.resets_in_hours }} hours</p>
                {% endif %}
            </div>
        </div>

        <!-- Concurrent Downloads -->
        <div class="bg-white/70 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl p-6 mb-6">
            <h2 class="text-lg font-semibold text-slate-900 mb-4">Active Downloads</h2>

            <div class="mb-4">
                <div class="flex justify-between text-sm mb-2">
                    <span class="text-slate-600">{{ limits.concurrent_downloads.current }} / {{
                        limits.concurrent_downloads.max }} concurrent streams</span>
                    <span
                        class="font-semibold {% if limits.concurrent_downloads.current >= limits.concurrent_downloads.max %}text-red-600{% else %}text-ag-cyan-600{% endif %}">
                        {{ limits.concurrent_downloads.percentage }}%
                    </span>
                </div>
                <div class="w-full h-3 bg-slate-200 rounded-full overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-ag-cyan-500 to-blue-500 transition-all duration-300"
                        style="width: {{ limits.concurrent_downloads.percentage }}%"></div>
                </div>
                {% if limits.concurrent_downloads.current >= limits.concurrent_downloads.max %}
                <p class="text-sm text-red-600 mt-2">⚠ Maximum concurrent downloads reached</p>
                {% else %}
                <p class="text-sm text-slate-600 mt-2">Free plan allows {{ limits.concurrent_downloads.max }} concurrent
                    download</p>
                {% endif %}
            </div>
        </div>

        <!-- File Size Limit -->
        <div class="bg-white/70 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl p-6 mb-6">
            <h2 class="text-lg font-semibold text-slate-900 mb-4">File Size Limit</h2>
            <p class="text-3xl font-bold text-ag-cyan-600">{{ limits.file_size_limit_mb }} MB</p>
            <p class="text-slate-600 text-sm mt-2">Maximum file size per upload</p>
        </div>

        <!-- Storage Used -->
        <div class="bg-white/70 backdrop-blur-xl border border-white/20 rounded-2xl shadow-xl p-6">
            <h2 class="text-lg font-semibold text-slate-900 mb-4">Storage Used</h2>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <p class="text-3xl font-bold text-ag-cyan-600">{{ (total_size / (1024**3)) | round(1) }} GB</p>
                    <p class="text-slate-600 text-sm mt-1">Total storage</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-ag-blue-600">{{ total_files }}</p>
                    <p class="text-slate-600 text-sm mt-1">Total files</p>
                </div>
            </div>

            <div class="mt-4 flex items-center gap-2 text-sm text-slate-600">
                <span>✓</span>
                <span>Unlimited storage via Telegram</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}